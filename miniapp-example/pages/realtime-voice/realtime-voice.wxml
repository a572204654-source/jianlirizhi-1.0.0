<view class="container">
  <!-- 页面标题 -->
  <view class="page-title">实时语音识别</view>

  <!-- 统计信息 -->
  <view class="stats-card">
    <view class="stat-item">
      <text class="stat-value">{{stats.totalCount}}</text>
      <text class="stat-label">总次数</text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{stats.todayCount}}</text>
      <text class="stat-label">今日</text>
    </view>
    <view class="stat-item">
      <text class="stat-value">{{stats.weekCount}}</text>
      <text class="stat-label">本周</text>
    </view>
  </view>

  <!-- 连接状态 -->
  <view class="status-bar">
    <view class="status-dot {{isConnected ? 'connected' : ''}}"></view>
    <text class="status-text">{{isConnected ? '已连接' : '未连接'}}</text>
  </view>

  <!-- 录音按钮 -->
  <view class="record-section">
    <view class="record-button-wrapper">
      <view 
        class="record-button {{isRecording ? 'recording' : ''}}"
        bindtouchstart="startRecording"
        bindtouchend="stopRecording"
        bindtouchcancel="stopRecording"
      >
        <view class="record-icon">
          <text class="icon">{{isRecording ? '🎙️' : '🎤'}}</text>
        </view>
        <text class="record-text">{{statusText}}</text>
      </view>
    </view>
    <view class="record-hint">
      {{isRecording ? '松开结束' : '按住说话'}}
    </view>
  </view>

  <!-- 识别结果 -->
  <view class="result-section" wx:if="{{recognizedText || currentText}}">
    <view class="result-header">
      <text class="result-title">识别结果</text>
      <view class="result-actions">
        <button class="action-btn" size="mini" bindtap="copyText">复制</button>
        <button class="action-btn" size="mini" bindtap="clearText">清空</button>
      </view>
    </view>
    <view class="result-content">
      <text class="result-text">{{recognizedText || currentText}}</text>
    </view>
    <view class="result-footer">
      <button class="apply-btn" bindtap="applyToLog">应用到监理日志</button>
    </view>
  </view>

  <!-- 历史记录 -->
  <view class="history-section" wx:if="{{histories.length > 0}}">
    <view class="section-title">历史记录</view>
    <view class="history-list">
      <view 
        class="history-item"
        wx:for="{{histories}}"
        wx:key="id"
        bindtap="viewHistory"
        data-item="{{item}}"
      >
        <view class="history-content">
          <text class="history-text">{{item.recognizedText}}</text>
          <text class="history-time">{{item.createdAt}}</text>
        </view>
        <view class="history-actions">
          <button 
            class="delete-btn" 
            size="mini" 
            bindtap="deleteHistory" 
            data-id="{{item.id}}"
            catchtap="deleteHistory"
          >删除</button>
        </view>
      </view>
    </view>
  </view>

  <!-- 使用说明 -->
  <view class="tips-section">
    <view class="tips-title">💡 使用提示</view>
    <view class="tips-list">
      <text class="tip-item">• 按住"按住说话"按钮开始录音</text>
      <text class="tip-item">• 松开按钮自动识别</text>
      <text class="tip-item">• 识别结果可直接应用到监理日志</text>
      <text class="tip-item">• 支持实时识别，边说边显示</text>
      <text class="tip-item">• 建议在安静环境下使用，效果更好</text>
    </view>
  </view>
</view>

